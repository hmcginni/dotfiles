#!/bin/bash

repoPath=${PWD%/*}

destPath=("$HOME/bin")
destPath+=("$HOME/bin")
destPath+=("$HOME/lib/bash")
destPath+=("$HOME/Documents/MATLAB")
destPath+=("$HOME")
srcPath=("$repoPath/bash/bin")
srcPath+=("$repoPath/python")
srcPath+=("$repoPath/bash/lib")
srcPath+=("$repoPath/matlab")
srcPath+=("$repoPath/dots")

except="README .bashrc"
except=$(tr -s "[:blank:]" "|" <<< $except)

# Make directories

mkdir -p "${destPath[@]}"

# Copy files
arrIdx=$(seq 0 $(( ${#destPath[@]} - 1 )))
for idx in $arrIdx; do
    shopt -s dotglob
    for file in "${srcPath[$idx]}"/*; do
    	if [[ ! $file =~ ($except) ]]; then
	    dest="${destPath[$idx]}"
	    if [[ ! -e $dest/${file##*/} ]]; then
		ln -sv -t "$dest" "$file"
		# printf "\"%s\" -> \"%s\"\n" "$file" "$dest/${file##*/}"
	    fi
    	fi
    done
    shopt -u dotglob
done


