#!/bin/bash

if (( $# < 2 )); then
    printf "Not enough inputs specified (%s)\n" "$#"
    exit 1
fi

script_dir=$(readlink "$0")
repo_dir=${script_dir%%/bash*}

link_file_relpath="$1"
link_file_fullpath=$(realpath "$link_file_relpath")
link_dir=${link_file_fullpath%/*}
link_filename=${link_file_fullpath##*/}

shift

tgt_relpath_parts="$*"
tgt_relpath=$(tr "[:blank:]" "/" <<< "$tgt_relpath_parts")
tgt_dir="$repo_dir"/"$tgt_relpath"
tgt_file_fullpath="$tgt_dir"/"$link_filename"
mkdir -p "$tgt_dir"

mv -v "$link_file_fullpath" "$tgt_file_fullpath"
ln -sv -t "$link_dir" "$tgt_file_fullpath"

